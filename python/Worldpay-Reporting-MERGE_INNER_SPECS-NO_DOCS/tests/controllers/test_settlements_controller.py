
"""
reportingapi

This file was automatically generated by APIMATIC v3.0 (
 https://www.apimatic.io ).
"""

# ruff: noqa: PLR0915, W291
from apimatic_core.utilities.comparison_helper import (
    ComparisonHelper,
)

from reportingapi.api_helper import APIHelper
from reportingapi.models.monthly_tran_summary_input_chain import (
    MonthlyTranSummaryInputCHAIN,
)
from reportingapi.models.settlements_request import (
    SettlementsRequest,
)
from reportingapi.models.settlements_request_by_merchant import (
    SettlementsRequestByMERCHANT,
)
from reportingapi.models.settlements_request_by_store import (
    SettlementsRequestBySTORE,
)
from reportingapi.models.settlements_summary_request import (
    SettlementsSummaryRequest,
)
from tests.controllers.controller_test_base import (
    ControllerTestBase,
)


class SettlementsControllerTests(ControllerTestBase):
    """
    Endpoint tests for validating the API behavior.

    Ensures controller methods execute correctly and produce the expected
    responses using the shared test client and response catcher.
    """

    controller = None

    @classmethod
    def setUpClass(cls):
        """
        Initialize the shared test client and controller for all test methods.
        """
        super().setUpClass()
        cls.controller = cls.client.settlements
        cls.response_catcher = cls.controller.http_call_back

    def test_retrieve_transaction_details_by_credit_transaction_id(self):
        """
        Endpoint is used to retrieve the details for a individual transaction.
        """
        # Parameters for the API call
        transaction_id = "141710009519"
        v_correlation_id = "a0efdf0f-eb0b-4353-80bb-ec520e02885e"

        # Perform the API call through the SDK function
        self.controller.retrieve_transaction_details_by_credit_transaction_id(
            transaction_id,
            v_correlation_id,
        )
        # Test response code
        assert self.response_catcher.response.status_code == 200
        # Test headers
        expected_headers = {
            "content-type": "application/json",
        }

        assert ComparisonHelper.match_headers(
            expected_headers,
            self.response_catcher.response.headers,
        )

    def test_retrieve_transaction_details_by_debit_transaction_id(self):
        """
        Endpoint is used to retrieve the details for an individual transaction.
        """
        # Parameters for the API call
        transaction_id = "141710009519"
        v_correlation_id = "a0efdf0f-eb0b-4353-80bb-ec520e02885e"

        # Perform the API call through the SDK function
        self.controller.retrieve_transaction_details_by_debit_transaction_id(
            transaction_id,
            v_correlation_id,
        )
        # Test response code
        assert self.response_catcher.response.status_code == 200
        # Test headers
        expected_headers = {
            "content-type": "application/json",
        }

        assert ComparisonHelper.match_headers(
            expected_headers,
            self.response_catcher.response.headers,
        )

    def test_retrieve_transaction_details_by_gift_transaction_id(self):
        """
        Endpoint is used to retrieve the details for an individual transaction.
        """
        # Parameters for the API call
        transaction_id = "141710009519"
        v_correlation_id = "a0efdf0f-eb0b-4353-80bb-ec520e02885e"

        # Perform the API call through the SDK function
        self.controller.retrieve_transaction_details_by_gift_transaction_id(
            transaction_id,
            v_correlation_id,
        )
        # Test response code
        assert self.response_catcher.response.status_code == 200
        # Test headers
        expected_headers = {
            "content-type": "application/json",
        }

        assert ComparisonHelper.match_headers(
            expected_headers,
            self.response_catcher.response.headers,
        )

    def test_getsettlementssummary(self):
        """
        Resource to get total summary of settlements for given hierarchy and date range
        with card type and card network being optional parameters. Refer to the  schema
        object for the allowed hierarchies and specifications.
        """
        # Parameters for the API call
        v_correlation_id = "a0efdf0f-eb0b-4353-80bb-ec520e02885e"
        body = APIHelper.json_deserialize(
            "{\"hierarchy\":{\"level\":\"MERCHANT\",\"values\":[\"4445000123456"
            "\",\"4345023507756\"]},\"dateRange\":{\"fromDate\":\"2019-07-27\","
            "\"toDate\":\"2019-09-13\"}}",
            SettlementsRequest.from_dictionary,
        )

        # Perform the API call through the SDK function
        result = self.controller.getsettlementssummary(
            v_correlation_id,
            body,
        )
        # Test response code
        assert self.response_catcher.response.status_code == 200
        # Test headers
        expected_headers = {
            "v-correlation-id": "None",
            "content-type": "application/json",
        }

        assert ComparisonHelper.match_headers(
            expected_headers,
            self.response_catcher.response.headers,
        )
        # Test whether the captured response is as we expected
        assert result is not None
        expected_body = APIHelper.json_deserialize(
            "{\"totalSaleCount\":200,\"totalSaleAmount\":2000.11,\"totalReturnC"
            "ount\":218,\"totalReturnAmount\":844.28,\"totalNetAmount\":1155.72"
            "}",
        )
        received_body = APIHelper.json_deserialize(
            self.response_catcher.response.text,
        )
        assert ComparisonHelper.match_body(
            expected_body,
            received_body,
        )

    def test_getsettlementssummarybycardnetwork(self):
        """
        Resource to get summary of settlements grouped by card network for given
        hierarchy and date range with card type and card network being optional
        parameters. Refer to the schema object for the allowed hierarchies and
        specifications.
        """
        # Parameters for the API call
        v_correlation_id = "a0efdf0f-eb0b-4353-80bb-ec520e02885e"
        body = APIHelper.json_deserialize(
            "{\"hierarchy\":{\"level\":\"MERCHANT\",\"values\":[\"4445000123456"
            "\",\"4345023507756\"]},\"pagination\":{\"pageNumber\":1,\"pageSize"
            "\":25},\"dateRange\":{\"fromDate\":\"2019-07-27\",\"toDate\":\"201"
            "9-09-13\"}}",
            SettlementsSummaryRequest.from_dictionary,
        )

        # Perform the API call through the SDK function
        result = self.controller.getsettlementssummarybycardnetwork(
            v_correlation_id,
            body,
        )
        # Test response code
        assert self.response_catcher.response.status_code == 200
        # Test headers
        expected_headers = {
            "v-correlation-id": "None",
            "content-type": "application/json",
        }

        assert ComparisonHelper.match_headers(
            expected_headers,
            self.response_catcher.response.headers,
        )
        # Test whether the captured response is as we expected
        assert result is not None
        expected_body = APIHelper.json_deserialize(
            "{\"pagination\":{\"pageNumber\":1,\"pageSize\":25,\"totalRowCount"
            "\":85,\"totalReturnedCount\":25},\"totalSaleCount\":25,\"totalSale"
            "Amount\":257.35,\"totalReturnCount\":20,\"totalReturnAmount\":36.4"
            "3,\"totalNetAmount\":236.79,\"summaries\":[{\"saleCount\":10,\"sal"
            "eAmount\":120.34,\"returnCount\":9,\"returnAmount\":20.56,\"netAmo"
            "unt\":99.78,\"cardType\":\"CREDIT\",\"cardNetwork\":{\"code\":\"L,"
            "\",\"shortDescription\":\"BILL_ME_LATER\",\"longDescription\":\"BI"
            "LL_ME_LATER\"}},{\"saleCount\":15,\"saleAmount\":137.01,\"returnCo"
            "unt\":11,\"returnAmount\":15.87,\"netAmount\":137.01,\"cardType\":"
            "\"DEBIT\",\"cardNetwork\":{\"code\":\"07\",\"shortDescription\":\""
            "EBT\",\"longDescription\":\"EBT\"}}]}",
        )
        received_body = APIHelper.json_deserialize(
            self.response_catcher.response.text,
        )
        assert ComparisonHelper.match_body(
            expected_body,
            received_body,
        )

    def test_getsettlementssummarybycardtype(self):
        """
        Resource to get summary of settlements grouped by card type for given hierarchy
        and date range with card type and card network being optional parameters. Refer
        to the schema object for the allowed hierarchies and specifications.
        """
        # Parameters for the API call
        v_correlation_id = "a0efdf0f-eb0b-4353-80bb-ec520e02885e"
        body = APIHelper.json_deserialize(
            "{\"hierarchy\":{\"level\":\"MERCHANT\",\"values\":[\"4445000123456"
            "\",\"4345023507756\"]},\"pagination\":{\"pageNumber\":1,\"pageSize"
            "\":25},\"dateRange\":{\"fromDate\":\"2019-07-27\",\"toDate\":\"201"
            "9-09-13\"}}",
            SettlementsSummaryRequest.from_dictionary,
        )

        # Perform the API call through the SDK function
        result = self.controller.getsettlementssummarybycardtype(
            v_correlation_id,
            body,
        )
        # Test response code
        assert self.response_catcher.response.status_code == 200
        # Test headers
        expected_headers = {
            "v-correlation-id": "None",
            "content-type": "application/json",
        }

        assert ComparisonHelper.match_headers(
            expected_headers,
            self.response_catcher.response.headers,
        )
        # Test whether the captured response is as we expected
        assert result is not None
        expected_body = APIHelper.json_deserialize(
            "{\"pagination\":{\"pageNumber\":1,\"pageSize\":25,\"totalRowCount"
            "\":85,\"totalReturnedCount\":25},\"totalSaleCount\":25,\"totalSale"
            "Amount\":257.35,\"totalReturnCount\":20,\"totalReturnAmount\":36.4"
            "3,\"totalNetAmount\":236.79,\"summaries\":[{\"saleCount\":10,\"sal"
            "eAmount\":120.34,\"returnCount\":9,\"returnAmount\":20.56,\"netAmo"
            "unt\":99.78,\"cardType\":\"CREDIT\"},{\"saleCount\":15,\"saleAmoun"
            "t\":137.01,\"returnCount\":11,\"returnAmount\":15.87,\"netAmount\""
            ":137.01,\"cardType\":\"DEBIT\"}]}",
        )
        received_body = APIHelper.json_deserialize(
            self.response_catcher.response.text,
        )
        assert ComparisonHelper.match_body(
            expected_body,
            received_body,
        )

    def test_getsettlementssummarybyprocessdate(self):
        """
        Resource to get summary of settlements grouped by process dates for given
        hierarchy and date range with card type and card network being optional
        parameters. Refer to the schema object for the allowed hierarchies and
        specifications.
        """
        # Parameters for the API call
        v_correlation_id = "a0efdf0f-eb0b-4353-80bb-ec520e02885e"
        body = APIHelper.json_deserialize(
            "{\"hierarchy\":{\"level\":\"MERCHANT\",\"values\":[\"4445000123456"
            "\",\"4345023507756\"]},\"pagination\":{\"pageNumber\":1,\"pageSize"
            "\":25},\"dateRange\":{\"fromDate\":\"2019-07-27\",\"toDate\":\"201"
            "9-09-13\"}}",
            SettlementsSummaryRequest.from_dictionary,
        )

        # Perform the API call through the SDK function
        result = self.controller.getsettlementssummarybyprocessdate(
            v_correlation_id,
            body,
        )
        # Test response code
        assert self.response_catcher.response.status_code == 200
        # Test headers
        expected_headers = {
            "v-correlation-id": "None",
            "content-type": "application/json",
        }

        assert ComparisonHelper.match_headers(
            expected_headers,
            self.response_catcher.response.headers,
        )
        # Test whether the captured response is as we expected
        assert result is not None
        expected_body = APIHelper.json_deserialize(
            "{\"pagination\":{\"pageNumber\":1,\"pageSize\":25,\"totalRowCount"
            "\":85,\"totalReturnedCount\":25},\"totalSaleCount\":25,\"totalSale"
            "Amount\":257.35,\"totalReturnCount\":20,\"totalReturnAmount\":36.4"
            "3,\"totalNetAmount\":236.79,\"summaries\":[{\"saleCount\":10,\"sal"
            "eAmount\":120.34,\"returnCount\":9,\"returnAmount\":20.56,\"netAmo"
            "unt\":99.78,\"processDate\":\"2019-07-27\"},{\"saleCount\":15,\"sa"
            "leAmount\":137.01,\"returnCount\":11,\"returnAmount\":15.87,\"netA"
            "mount\":137.01,\"processDate\":\"2019-07-28\"}]}",
        )
        received_body = APIHelper.json_deserialize(
            self.response_catcher.response.text,
        )
        assert ComparisonHelper.match_body(
            expected_body,
            received_body,
        )

    def test_getsettlementssummarybymerchant(self):
        """
        Resource to get summary of settlements grouped by merchants for given hierarchy
        and date range with card type and card network being optional parameters. Refer
        to the schema object for the allowed hierarchies and specifications.
        """
        # Parameters for the API call
        v_correlation_id = "a0efdf0f-eb0b-4353-80bb-ec520e02885e"
        body = APIHelper.json_deserialize(
            "{\"hierarchy\":{\"level\":\"MERCHANT\",\"values\":[\"4445000123456"
            "\",\"4345023507756\"]},\"pagination\":{\"pageNumber\":1,\"pageSize"
            "\":25},\"dateRange\":{\"fromDate\":\"2019-07-27\",\"toDate\":\"201"
            "9-09-13\"}}",
            SettlementsRequestByMERCHANT.from_dictionary,
        )

        # Perform the API call through the SDK function
        result = self.controller.getsettlementssummarybymerchant(
            v_correlation_id,
            body,
        )
        # Test response code
        assert self.response_catcher.response.status_code == 200
        # Test headers
        expected_headers = {
            "v-correlation-id": "None",
            "content-type": "application/json",
        }

        assert ComparisonHelper.match_headers(
            expected_headers,
            self.response_catcher.response.headers,
        )
        # Test whether the captured response is as we expected
        assert result is not None
        expected_body = APIHelper.json_deserialize(
            "{\"pagination\":{\"pageNumber\":1,\"pageSize\":25,\"totalRowCount"
            "\":85,\"totalReturnedCount\":25},\"totalSaleCount\":25,\"totalSale"
            "Amount\":257.35,\"totalReturnCount\":20,\"totalReturnAmount\":36.4"
            "3,\"totalNetAmount\":236.79,\"summaries\":[{\"saleCount\":10,\"sal"
            "eAmount\":120.34,\"returnCount\":9,\"returnAmount\":20.56,\"netAmo"
            "unt\":99.78,\"merchantId\":\"4445000123456\"},{\"saleCount\":15,\""
            "saleAmount\":137.01,\"returnCount\":11,\"returnAmount\":15.87,\"ne"
            "tAmount\":137.01,\"merchantId\":\"4345023507756\"}]}",
        )
        received_body = APIHelper.json_deserialize(
            self.response_catcher.response.text,
        )
        assert ComparisonHelper.match_body(
            expected_body,
            received_body,
        )

    def test_getsettlementssummarybystore(self):
        """
        Resource to get summary of settlements grouped by stores for given hierarchy
        and date range with card type and card network being optional parameters. Refer
        to the schema object for the allowed hierarchies and specifications.
        """
        # Parameters for the API call
        v_correlation_id = "a0efdf0f-eb0b-4353-80bb-ec520e02885e"
        body = APIHelper.json_deserialize(
            "{\"hierarchy\":{\"level\":\"CHAIN\",\"values\":[\"AB1234\",\"11121"
            "7\"]},\"pagination\":{\"pageNumber\":1,\"pageSize\":25},\"dateRang"
            "e\":{\"fromDate\":\"2019-07-27\",\"toDate\":\"2019-09-12\"}}",
            SettlementsRequestBySTORE.from_dictionary,
        )

        # Perform the API call through the SDK function
        result = self.controller.getsettlementssummarybystore(
            v_correlation_id,
            body,
        )
        # Test response code
        assert self.response_catcher.response.status_code == 200
        # Test headers
        expected_headers = {
            "v-correlation-id": "None",
            "content-type": "application/json",
        }

        assert ComparisonHelper.match_headers(
            expected_headers,
            self.response_catcher.response.headers,
        )
        # Test whether the captured response is as we expected
        assert result is not None
        expected_body = APIHelper.json_deserialize(
            "{\"pagination\":{\"pageNumber\":1,\"pageSize\":25,\"totalRowCount"
            "\":85,\"totalReturnedCount\":25},\"totalSaleCount\":25,\"totalSale"
            "Amount\":257.35,\"totalReturnCount\":20,\"totalReturnAmount\":36.4"
            "3,\"totalNetAmount\":236.79,\"summaries\":[{\"saleCount\":10,\"sal"
            "eAmount\":120.34,\"returnCount\":9,\"returnAmount\":20.56,\"netAmo"
            "unt\":99.78,\"chainCode\":\"AB1234\",\"storeNumber\":\"000000012\""
            "},{\"saleCount\":15,\"saleAmount\":137.01,\"returnCount\":11,\"ret"
            "urnAmount\":15.87,\"netAmount\":137.01,\"chainCode\":\"AB1234\",\""
            "storeNumber\":\"000000023\"}]}",
        )
        received_body = APIHelper.json_deserialize(
            self.response_catcher.response.text,
        )
        assert ComparisonHelper.match_body(
            expected_body,
            received_body,
        )

    def test_getsettlementssummarybychain(self):
        """
        Resource to get summary of settlements grouped by chain for given hierarchy and
        date range with card type and card network being optional parameters. Refer to
        the schema object for the allowed hierarchies and specifications.
        """
        # Parameters for the API call
        v_correlation_id = "a0efdf0f-eb0b-4353-80bb-ec520e02885e"
        body = None

        # Perform the API call through the SDK function
        result = self.controller.getsettlementssummarybychain(
            v_correlation_id,
            body,
        )
        # Test response code
        assert self.response_catcher.response.status_code == 200
        # Test headers
        expected_headers = {
            "v-correlation-id": "None",
            "content-type": "application/json",
        }

        assert ComparisonHelper.match_headers(
            expected_headers,
            self.response_catcher.response.headers,
        )
        # Test whether the captured response is as we expected
        assert result is not None
        expected_body = APIHelper.json_deserialize(
            "{\"pagination\":{\"pageNumber\":1,\"pageSize\":25,\"totalRowCount"
            "\":85,\"totalReturnedCount\":25},\"totalSaleCount\":25,\"totalSale"
            "Amount\":257.35,\"totalReturnCount\":20,\"totalReturnAmount\":36.4"
            "3,\"totalNetAmount\":236.79,\"summaries\":[{\"saleCount\":10,\"sal"
            "eAmount\":120.34,\"returnCount\":9,\"returnAmount\":20.56,\"netAmo"
            "unt\":99.78,\"chainCode\":\"AB1234\"},{\"saleCount\":15,\"saleAmou"
            "nt\":137.01,\"returnCount\":11,\"returnAmount\":15.87,\"netAmount"
            "\":137.01,\"chainCode\":\"111217\"}]}",
        )
        received_body = APIHelper.json_deserialize(
            self.response_catcher.response.text,
        )
        assert ComparisonHelper.match_body(
            expected_body,
            received_body,
        )

    def test_get_settlements_summary_bysuperchain(self):
        """
        Resource to get summary of settlements grouped by super chain for given
        hierarchy and date range with card type and card network being optional
        parameters. Refer to the schema object for the allowed hierarchies and
        specifications.
        """
        # Parameters for the API call
        v_correlation_id = "a0efdf0f-eb0b-4353-80bb-ec520e02885e"
        body = None

        # Perform the API call through the SDK function
        result = self.controller.get_settlements_summary_bysuperchain(
            v_correlation_id,
            body,
        )
        # Test response code
        assert self.response_catcher.response.status_code == 200
        # Test headers
        expected_headers = {
            "v-correlation-id": "None",
            "content-type": "application/json",
        }

        assert ComparisonHelper.match_headers(
            expected_headers,
            self.response_catcher.response.headers,
        )
        # Test whether the captured response is as we expected
        assert result is not None
        expected_body = APIHelper.json_deserialize(
            "{\"pagination\":{\"pageNumber\":1,\"pageSize\":25,\"totalRowCount"
            "\":85,\"totalReturnedCount\":25},\"totalSaleCount\":25,\"totalSale"
            "Amount\":257.35,\"totalReturnCount\":20,\"totalReturnAmount\":36.4"
            "3,\"totalNetAmount\":236.79,\"summaries\":[{\"saleCount\":10,\"sal"
            "eAmount\":120.34,\"returnCount\":9,\"returnAmount\":20.56,\"netAmo"
            "unt\":99.78,\"superChainCode\":\"SCNPCB6111\"},{\"saleCount\":15,"
            "\"saleAmount\":137.01,\"returnCount\":11,\"returnAmount\":15.87,\""
            "netAmount\":137.01,\"superChainCode\":\"SCNPCB8811\"}]}",
        )
        received_body = APIHelper.json_deserialize(
            self.response_catcher.response.text,
        )
        assert ComparisonHelper.match_body(
            expected_body,
            received_body,
        )

    def test_getsettlementssummarybymonth(self):
        """
        API to return settled transaction summary details by month for a single chain.
        """
        # Parameters for the API call
        v_correlation_id = "a0efdf0f-eb0b-4353-80bb-ec520e02885e"
        body = APIHelper.json_deserialize(
            "{\"chainCode\":\"111186\",\"dateRange\":{\"startMonth\":\"2023-03"
            "\",\"endMonth\":\"2023-06\"}}",
            MonthlyTranSummaryInputCHAIN.from_dictionary,
        )

        # Perform the API call through the SDK function
        result = self.controller.getsettlementssummarybymonth(
            v_correlation_id,
            body,
        )
        # Test response code
        assert self.response_catcher.response.status_code == 200
        # Test headers
        expected_headers = {
            "v-correlation-id": "None",
            "content-type": "application/json",
        }

        assert ComparisonHelper.match_headers(
            expected_headers,
            self.response_catcher.response.headers,
        )
        # Test whether the captured response is as we expected
        assert result is not None
        expected_body = APIHelper.json_deserialize(
            "{\"details\":{\"chainCode\":\"111186\",\"totalChargebackSalesCount"
            "\":116,\"totalChargebackSalesAmount\":158624.05,\"totalTransaction"
            "Amount\":8.87,\"totalTransactionCount\":7,\"processMonthStart\":\""
            "2023-03\",\"processMonthEnd\":\"2023-06\"}}",
        )
        received_body = APIHelper.json_deserialize(
            self.response_catcher.response.text,
        )
        assert ComparisonHelper.match_body(
            expected_body,
            received_body,
        )

