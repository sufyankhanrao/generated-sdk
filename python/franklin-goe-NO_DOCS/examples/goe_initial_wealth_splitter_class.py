import jsonpickle
import logging

from goeapi.configuration import Environment
from goeapi.exceptions.api_exception import ApiException
from goeapi.exceptions.internal_server_message_exception import InternalServerMessageException
from goeapi.exceptions.message_exception import MessageException
from goeapi.exceptions.validation_message_one_exception import ValidationMessageOneException
from goeapi.goeapi_client import GoeapiClient
from goeapi.http.auth.oauth_2 import BearerAuthCredentials
from goeapi.logging.configuration.api_logging_configuration import LoggingConfiguration
from goeapi.logging.configuration.api_logging_configuration import RequestLoggingConfiguration
from goeapi.logging.configuration.api_logging_configuration import ResponseLoggingConfiguration
from goeapi.models.goal_profile_list_wealth_splitter_model import GoalProfileListWealthSplitterModel
from goeapi.models.risk_profile_8 import RiskProfile8
from goeapi.models.wealth_splitter_input_model import WealthSplitterInputModel
from goeapi.models.weath_splitter_goal_priority_attribute import WeathSplitterGoalPriorityAttribute

client = GoeapiClient(
    bearer_auth_credentials=BearerAuthCredentials(
        access_token='AccessToken'
    ),
    environment=Environment.UAT,
    logging_configuration=LoggingConfiguration(
        log_level=logging.INFO,
        request_logging_config=RequestLoggingConfiguration(
            log_body=True
        ),
        response_logging_config=ResponseLoggingConfiguration(
            log_headers=True
        )
    )
)

goe_api = client.goe
body = WealthSplitterInputModel(
    start_date='1-01-2020',
    risk_profile=RiskProfile8.CONSERVATIVE,
    goal_profile_list=[
        GoalProfileListWealthSplitterModel(
            goal_id='Goal_1',
            goal_value=1000000,
            purpose='Saving',
            curr_wealth=141412,
            goal_priority=WeathSplitterGoalPriorityAttribute.NEED,
            cashflow_type='monthly',
            cashflow=[
                0,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                400,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                -15000,
                0
            ],
            end_date='10-10-2080',
            scenario_type='retirement',
            cashflow_date='15-06-2020',
            loss_threshold=None,
            additional_properties={
                'goal_priority_prob': jsonpickle.decode('0.85')
            }
        ),
        GoalProfileListWealthSplitterModel(
            goal_id='Goal_2',
            goal_value=1000000,
            purpose='Fixed',
            curr_wealth=897494,
            goal_priority=WeathSplitterGoalPriorityAttribute.DREAM,
            cashflow_type='yearly',
            cashflow=[
                0,
                4000,
                -30000,
                0
            ],
            end_date='10-10-2023',
            scenario_type='retirement',
            cashflow_date='11-10-2020',
            loss_threshold=None,
            additional_properties={
                'goal_priority_prob': jsonpickle.decode('0.5')
            }
        )
    ],
    curr_date='13-01-2021'
)

try:
    result = goe_api.initial_wealth_splitter(body)

    if result.is_success():
        print(result.body)
    elif result.is_error():
        print(result.errors)

except ValidationMessageOneException as e: 
    print(e)
except MessageException as e: 
    print(e)
except InternalServerMessageException as e: 
    print(e)
except ApiException as e: 
    print(e)

